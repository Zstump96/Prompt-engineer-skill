---
# Prompt Engineer Skill - Configuration
# All settings in one file for clarity and deployment

version: 1.0.0
skill_name: prompt-engineer
author: Savant Signal

# =============================================================================
# SCORING DIMENSIONS & WEIGHTS
# =============================================================================

scoring:
  dimensions:
    clarity:
      weight: 0.25
      criteria:
        - name: action_verb
          weight: 0.25
          strong_verbs: [Identify, Extract, Transform, Classify, Calculate]
          moderate_verbs: [Analyze, Evaluate, Determine]
          weak_verbs: [Get, Make, Handle, Do]
          scores:
            strong: 25
            moderate: 20
            weak: 15
            missing: 0
            
        - name: output_format
          weight: 0.25
          specific_formats: [JSON, CSV, SQL, table, memo, list]
          scores:
            specific: 25
            defined_but_vague: 15
            undefined: 0
            
        - name: target_audience
          weight: 0.20
          scores:
            specific: 20
            generic: 10
            undefined: 0
            
        - name: constraints
          weight: 0.20
          require_quantification: true
          scores:
            quantified: 20
            vague: 10
            missing: 0
            
        - name: examples
          weight: 0.10
          min_for_full_score: 2
          counter_example_bonus: true
          scores:
            two_plus_with_counter: 10
            one_example: 7
            missing: 0
    
    completeness:
      weight: 0.25
      criteria:
        - name: data_sources
          weight: 0.25
          required_fields: [name, source, refresh_rate, access_method]
          scores:
            all_fields: 25
            missing_some: 15
            only_name: 5
            missing: 0
            
        - name: contextual_facts
          weight: 0.25
          min_facts_for_full_score: 2
          scores:
            multiple_quantified: 25
            one_or_assumed: 15
            missing: 0
            
        - name: definitions
          weight: 0.20
          scores:
            all_terms: 20
            most_terms: 12
            few_terms: 5
            missing: 0
            
        - name: fallback_behavior
          weight: 0.20
          scores:
            all_conditions: 20
            some_conditions: 10
            missing: 0
            
        - name: verification_method
          weight: 0.10
          scores:
            method_specified: 10
            partial: 5
            missing: 0
    
    correctness:
      weight: 0.25
      criteria:
        - name: math_formalized
          weight: 0.30
          scores:
            equations_with_variables: 30
            some_narrative: 15
            all_narrative: 0
            
        - name: sources_verified
          weight: 0.25
          required_info: [name, date, validation]
          scores:
            full_verification: 25
            date_only: 15
            name_only: 5
            missing: 0
            
        - name: causal_claims
          weight: 0.25
          scores:
            mechanism_explained: 25
            implied_mechanism: 15
            correlation_as_cause: 0
            
        - name: internal_consistency
          weight: 0.20
          contradiction_penalty: 5  # per unresolved "but", "however", "unless"
          scores:
            no_contradictions: 20
            resolvable: 10
            unresolved: 0
    
    execution_viability:
      weight: 0.25
      criteria:
        - name: anthropic_pattern
          weight: 0.25
          required_pattern: "[Action][Input][Output][Constraint]"
          scores:
            explicit_pattern: 25
            three_of_four: 15
            two_or_fewer: 0
            
        - name: apis_documented
          weight: 0.20
          required_fields: [name, url, access_method, cost_limit]
          scores:
            fully_documented: 20
            missing_access_or_limit: 10
            undocumented: 0
            
        - name: computational_cost
          weight: 0.20
          max_time_seconds: 60
          max_cost_usd: 1.0
          scores:
            within_limits: 20
            moderate_overrun: 12
            significant_overrun: 5
            
        - name: output_actionable
          weight: 0.20
          actionable_formats: [JSON, SQL, CSV, structured]
          scores:
            machine_parseable: 20
            structured_prose: 12
            vague_prose: 0
            
        - name: testable
          weight: 0.15
          min_test_cases: 5
          scores:
            sandbox_testable: 15
            partially_testable: 8
            requires_apis: 0

  overall:
    formula: "(clarity + completeness + correctness + execution_viability) / 4"
    grades:
      excellent: [90, 100]
      good: [80, 89]
      fair: [70, 79]
      poor: [0, 69]

# =============================================================================
# DESIGN PATTERNS LIBRARY
# =============================================================================

patterns:
  anthropic:
    - id: ANTH_001
      name: "Task + Format + Constraints"
      template: "[ACTION] [INPUT] into [OUTPUT] with [CONSTRAINT] for [AUDIENCE]"
      effectiveness: "very_high"
      usage_rate: 0.40
      
    - id: ANTH_002
      name: "Context + Background + Reasoning"
      template: "Given [FACTS], [ACTION], show [STEP→STEP→STEP]"
      effectiveness: "high"
      usage_rate: 0.45
      
    - id: ANTH_003
      name: "Pre-specified Categories"
      template: "CATEGORIZE into [CAT1], [CAT2], [CAT3] with definitions + examples"
      effectiveness: "high"
      usage_rate: 0.35
      
    - id: ANTH_004
      name: "Collaborative Iteration"
      template: "Propose → Options → Iterate → Finalize"
      effectiveness: "medium"
      usage_rate: 0.20
      
    - id: ANTH_005
      name: "Constraint-Based"
      template: "All constraints listed with explicit fallback for each"
      effectiveness: "very_high"
      usage_rate: 0.45
      required_for: [risk_management, financial_decisions, safety_critical]

  google_cloud:
    - id: GCP_001
      name: "Set Clear Goals & Objectives"
      practices:
        - "Use action verbs (Identify, Extract, Transform)"
        - "Define output format explicitly"
        - "Specify target audience"
      effectiveness: "universal"
      
    - id: GCP_002
      name: "Provide Context & Background"
      practices:
        - "Include relevant facts and data"
        - "Reference specific sources"
        - "Define key terms"
      effectiveness: "universal"
      
    - id: GCP_003
      name: "Few-Shot Prompting"
      practices:
        - "Provide 2-3 example input-output pairs"
        - "Include counter-example"
        - "Show desired pattern"
      accuracy_improvement: 0.15  # 15-40% improvement documented
      
    - id: GCP_004
      name: "Be Specific & Quantify"
      practices:
        - "Use precise language"
        - "Quantify all requirements"
        - "Break down complex tasks"
      effectiveness: "universal"
      
    - id: GCP_005
      name: "Chain of Thought"
      practices:
        - "Encourage step-by-step reasoning"
        - "Ask for explanations"
        - "Guide through logical sequence"
      accuracy_improvement: 0.33  # 45% → 78% documented
      
    - id: GCP_006
      name: "Iterate & Experiment"
      practices:
        - "A/B test prompt versions"
        - "Measure improvement systematically"
        - "Refine based on results"
      effectiveness: "high"

# =============================================================================
# WEB SCRAPER CONFIGURATION
# =============================================================================

scraper:
  enabled: true
  schedule: "0 2 * * 1"  # Monday 2am UTC
  timeout_seconds: 30
  
  whitelist:
    - domain: anthropic.com
      paths: [/docs, /blog]
      rate_limit: 20  # requests per week
      
    - domain: cloud.google.com
      paths: [/discover/what-is-prompt-engineering, /blog]
      rate_limit: 20
      
    - domain: news.ycombinator.com
      keywords: [prompt, llm, ai, prompting]
      rate_limit: 15
      
    - domain: reddit.com
      subreddits: [/r/OpenAI, /r/LocalLLM]
      rate_limit: 15
      
    - domain: github.com
      paths: [/topics/prompt-engineering]
      rate_limit: 10
      
    - domain: twitter.com
      search_queries: ["#prompting", "#promptengineering"]
      rate_limit: 10
  
  global_limits:
    requests_per_second: 1
    max_weekly_requests: 100
    no_javascript: true
    no_cookies: true
    no_external_scripts: true
  
  data_extraction:
    fields: [title, author, date, code_blocks, definitions]
    exclude_pii: [emails, phone_numbers, api_keys]
    min_quality_score: 75  # Only integrate patterns >75/100
  
  storage:
    type: sqlite3
    location: knowledge_base/knowledge.db
    no_cloud_sync: true
    backup_frequency: weekly
  
  integration:
    method: weekly
    deduplication: semantic_similarity_threshold_0.85
    human_review_required: false  # Optional, for additional security
    version_control: true
    rollback_capable: true

# =============================================================================
# SOCRATIC OPTIMIZATION ENGINE
# =============================================================================

optimization:
  enabled: true
  method: socratic_dialogue  # Ask, don't tell
  
  strategies:
    shallow:
      duration_minutes: 5
      questions_count: 3
      focus: clarity_only
      expected_improvement: 10
      
    medium:
      duration_minutes: 15
      questions_count: 8
      focus: clarity_and_completeness
      expected_improvement: 25
      
    deep:
      duration_minutes: 30
      questions_count: 15
      focus: all_dimensions
      expected_improvement: 40
  
  socratic_method:
    - step: 1
      focus: discover_implicit_assumptions
      example: "What's the single most important action?"
      
    - step: 2
      focus: reveal_missing_specifications
      example: "How would you know the agent succeeded?"
      
    - step: 3
      focus: identify_target_context
      example: "Who specifically will use this? Background?"
      
    - step: 4
      focus: quantify_vague_criteria
      example: "If [constraint] violated, how bad?"
      
    - step: 5
      focus: elicit_concrete_examples
      example: "Show me exactly (good AND bad)?"
  
  dialogue_rules:
    - ask_one_question_at_a_time: true
    - listen_fully_before_next: true
    - build_on_previous_answers: true
    - genuine_inquiry_only: true
    - no_lecturing: true
    - celebrate_discoveries: true

# =============================================================================
# KNOWLEDGE BASE SCHEMA
# =============================================================================

database:
  schema:
    patterns_table:
      columns:
        - pattern_id: TEXT PRIMARY KEY
        - name: TEXT
        - definition: TEXT
        - score: REAL
        - source_url: TEXT
        - date_integrated: DATETIME
        - status: TEXT  # active, archived, deprecated
        - usage_count: INTEGER
        - effectiveness: TEXT
        
    scrape_history_table:
      columns:
        - scrape_id: TEXT PRIMARY KEY
        - date_executed: DATETIME
        - domains_crawled: INTEGER
        - patterns_extracted: INTEGER
        - patterns_integrated: INTEGER
        - status: TEXT  # success, partial, failed
        
    scoring_history_table:
      columns:
        - score_id: TEXT PRIMARY KEY
        - prompt_text: TEXT
        - clarity: REAL
        - completeness: REAL
        - correctness: REAL
        - execution_viability: REAL
        - overall: REAL
        - timestamp: DATETIME

# =============================================================================
# MAINTENANCE SCHEDULES
# =============================================================================

maintenance:
  weekly:
    time: "0 2 * * 1"  # Monday 2am UTC
    tasks:
      - web_scraping
      - pattern_extraction
      - pattern_scoring
      - deduplication
      - knowledge_base_update
      - digest_generation
    
  monthly:
    time: "0 3 1 * *"  # 1st of month, 3am UTC
    tasks:
      - effectiveness_review
      - deprecation_check  # patterns <10% usage + <70 score
      - usage_analysis
      - version_bump_if_needed
    
  quarterly:
    time: "0 4 1 */3 *"  # Quarterly, 4am UTC
    tasks:
      - deep_research_validation
      - google_cloud_practices_revalidation
      - anthropic_library_revalidation
      - scoring_methodology_audit
      - security_audit

# =============================================================================
# OPERATIONAL MODES
# =============================================================================

modes:
  score:
    description: "Analyze prompt on 4 dimensions"
    input: prompt_text
    output: scorecard_json
    timeout_seconds: 60
    
  optimize:
    description: "Improve weak prompt via Socratic dialogue"
    input: prompt_text
    output: socratic_questions + revised_prompt
    timeout_seconds: 300
    
  create:
    description: "Build new prompt from scratch"
    input: task_description, domain, audience
    output: new_prompt (typically >85/100)
    timeout_seconds: 300
    
  learn:
    description: "Query knowledge base for patterns"
    input: query_string
    output: matching_patterns_json
    timeout_seconds: 60
    
  verify:
    description: "Check learning status"
    input: period (week/month/quarter)
    output: digest_json
    timeout_seconds: 60

# =============================================================================
# SECURITY & COMPLIANCE
# =============================================================================

security:
  network:
    - http_get_only: true
    - no_post_put_delete: true
    - rate_limiting: "1 req/sec, 100/week max"
    - timeout: 30
    - whitelist_only: true
    
  data:
    - local_storage_only: true
    - no_cloud_sync: true
    - no_external_apis: true
    - no_pii_extraction: true
    
  execution:
    - sandboxed: true
    - audit_logging: true
    - no_external_reporting: true
    - rollback_capable: true
    
  compliance:
    - gdpr: "compliant (no PII collected)"
    - data_residency: "on-premises only"
    - reproducible: "fully local, no cloud"
    
  audit_status: "PASSED"

EOF
cat /home/claude/config_sonnet.yaml
